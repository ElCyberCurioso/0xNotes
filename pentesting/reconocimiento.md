# Reconocimiento

## ¿Qué es el reconocimiento?

El reconocimiento es la primera fase del pentesting donde se recopila información sobre el objetivo. Se divide en dos tipos:

## Tipos de Reconocimiento

### Reconocimiento Pasivo
No hay interacción directa con el objetivo. Se utilizan fuentes públicas de información.

**Ventajas:**
- No deja rastros
- No alerta al objetivo
- Legal en la mayoría de casos

**Técnicas:**
- OSINT (Open Source Intelligence)
- Búsqueda en Google (Google Dorking)
- Redes sociales
- Bases de datos públicas
- Registros WHOIS

### Reconocimiento Activo
Interacción directa con el objetivo para obtener información.

**Características:**
- Deja rastros en logs
- Puede alertar al objetivo
- Más preciso y actualizado

**Técnicas:**
- Escaneo de puertos
- DNS enumeration
- Network mapping
- Service fingerprinting

## OSINT (Open Source Intelligence)

### Herramientas de OSINT

#### theHarvester
Recopila emails, subdominios, IPs y URLs de diferentes fuentes públicas.

```bash
# Búsqueda básica
theHarvester -d ejemplo.com -b google

# Búsqueda en múltiples fuentes
theHarvester -d ejemplo.com -b google,bing,linkedin

# Guardar resultados
theHarvester -d ejemplo.com -b all -f resultados
```

#### Shodan
Motor de búsqueda para dispositivos conectados a Internet.

```bash
# Buscar servidores Apache
shodan search apache

# Buscar por IP
shodan host 8.8.8.8

# Buscar cámaras web
shodan search "webcam"
```

#### Google Dorking
Técnicas avanzadas de búsqueda en Google.

```
# Buscar archivos PDF en un sitio
site:ejemplo.com filetype:pdf

# Buscar directorios listables
intitle:"index of" site:ejemplo.com

# Buscar paneles de admin
inurl:admin site:ejemplo.com

# Buscar archivos de configuración expuestos
site:ejemplo.com ext:xml | ext:conf | ext:cnf | ext:reg | ext:inf

# Buscar información sensible
site:ejemplo.com intext:"password" | intext:"username"
```

### Reconocimiento de Subdominios

#### Subfinder
```bash
subfinder -d ejemplo.com -o subdominios.txt
```

#### Amass
```bash
# Enumeración pasiva
amass enum -passive -d ejemplo.com

# Enumeración activa
amass enum -active -d ejemplo.com -o resultados.txt
```

#### Sublist3r
```bash
python sublist3r.py -d ejemplo.com -o subdominios.txt
```

### WHOIS Lookup

```bash
# Información del dominio
whois ejemplo.com

# Información de IP
whois 8.8.8.8
```

### DNS Enumeration

```bash
# Consulta de registros A
dig ejemplo.com A

# Consulta de registros MX
dig ejemplo.com MX

# Consulta de registros NS
dig ejemplo.com NS

# Transfer de zona (si está mal configurado)
dig axfr @ns1.ejemplo.com ejemplo.com

# Consulta con nslookup
nslookup ejemplo.com

# Fuerza bruta de subdominios con dnsrecon
dnsrecon -d ejemplo.com -D subdomains.txt -t brt
```

## Reconocimiento de Redes Sociales

### Búsqueda de empleados
- LinkedIn: Información sobre la estructura organizacional
- Twitter: Tweets que pueden revelar información técnica
- Facebook: Información personal de empleados
- GitHub: Código fuente, configuraciones, credenciales expuestas

### Herramientas
```bash
# Social-Mapper: Correlacionar perfiles en redes sociales
python social-mapper.py -f lista_nombres.txt -m linkedin

# SpiderFoot: Automatización de OSINT
spiderfoot -s ejemplo.com
```

## Reconocimiento de Infraestructura

### Identificar tecnologías web

#### Wappalyzer
Extensión de navegador que identifica tecnologías web.

#### WhatWeb
```bash
whatweb ejemplo.com
whatweb -v ejemplo.com  # Verbose
```

#### BuiltWith
Servicio online: https://builtwith.com/

### Wayback Machine
Explorar versiones antiguas de sitios web que pueden contener información sensible.

```
https://web.archive.org/web/*/ejemplo.com
```

## Herramientas Todo-en-Uno

### Recon-ng
Framework modular de reconocimiento.

```bash
# Iniciar recon-ng
recon-ng

# Crear workspace
workspaces create ejemplo

# Agregar dominio
db insert domains ejemplo.com

# Instalar módulos
marketplace install all

# Usar un módulo
modules load recon/domains-hosts/google_site_web
run
```

### Maltego
Herramienta visual para análisis de relaciones y OSINT.

### SpiderFoot
```bash
# Escaneo completo
spiderfoot -s ejemplo.com -m all
```

## Checklist de Reconocimiento

- [ ] WHOIS lookup del dominio
- [ ] Enumeración de subdominios
- [ ] Google Dorking
- [ ] Búsqueda en Shodan
- [ ] Identificación de tecnologías web
- [ ] Búsqueda en redes sociales
- [ ] Enumeración de DNS
- [ ] Búsqueda de emails
- [ ] Exploración en Wayback Machine
- [ ] Búsqueda en GitHub/GitLab
- [ ] Identificación de empleados clave
- [ ] Mapeo de la infraestructura de red

## Notas Importantes

> [!TIP]
> Documenta TODO lo que encuentres. Información que parece irrelevante ahora puede ser crucial más tarde.

> [!WARNING]
> Incluso el reconocimiento pasivo puede ser detectado. Usa proxies/VPN y ten cuidado con las búsquedas automatizadas excesivas.

## Referencias

- [OSINT Framework](https://osintframework.com/)
- [Google Hacking Database](https://www.exploit-db.com/google-hacking-database)
- [Shodan](https://www.shodan.io/)
- [theHarvester](https://github.com/laramies/theHarvester)
